-- =======================================================
-- Lister les jobs actifs sans descriptions fonctionnelles
-- =======================================================
ALTER FUNCTION Adm.Jobs_SansDescription()
RETURNS TABLE 
AS
RETURN 
(
	SELECT name as Nom, 'Aucune Description' AS Probleme
	FROM msdb.dbo.sysjobs
	WHERE enabled = '1'
	  AND description = 'Pas de description disponible.'
	UNION
	SELECT name as Nom, 'Description manquante' AS Probleme
	FROM msdb.dbo.sysjobs
	WHERE enabled = '1'
	  AND description <> 'Pas de description disponible.'
	  AND description NOT LIKE '%Description:%'
	UNION
	SELECT name as Nom, 'Procedure de reprise manquante' AS Probleme
	FROM msdb.dbo.sysjobs
	WHERE enabled = '1'
	  AND description <> 'Pas de description disponible.'
	  AND description NOT LIKE '%Procedure de reprise:%'
	UNION
	SELECT name as Nom, 'Impacts manquants' AS Probleme
	FROM msdb.dbo.sysjobs
	WHERE enabled = '1'
	  AND description <> 'Pas de description disponible.'
	  AND description NOT LIKE '%Impacts:%'
	UNION
	SELECT name as Nom, 'Alerte manquante' AS Probleme
	FROM msdb.dbo.sysjobs
	WHERE enabled = '1'
	  AND description <> 'Pas de description disponible.'
	  AND description NOT LIKE '%Alerte:%'
)
GO
